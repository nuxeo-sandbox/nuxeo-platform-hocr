<?xml version="1.0"?>
<component name="org.nuxeo.ecm.platform.hocr.automation" version="1.0">

  <extension point="chains" target="org.nuxeo.ecm.core.operation.OperationServiceComponent">
    <chain id="Document.OCR.ToPDF">
      <operation id="Context.FetchDocument"/>
      <operation id="Context.SetInputAsVar">
        <param type="string" name="name">currentDocument</param>
      </operation>
      <!-- Source document with image -->
      <operation id="Document.OCRPrepare" />
      <!-- Blob is scaled image (binarized) -->
      <operation id="Blob.OCRExtract" />
      <!-- Blob is HOCR output -->
      <operation id="Blob.OCRPostProcess" />
      <operation id="Context.SetInputAsVar">
        <param type="string" name="name">text</param>
      </operation>
      <!-- HOCR saved off -->
      <operation id="Context.RestoreDocumentInput">
        <param type="string" name="name">currentDocument</param>
      </operation>
      <!-- Generate PDF -->
      <operation id="Document.OCRCombine" />
    </chain>
  </extension>

</component>
